<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>แดชบอร์ดสรุปข้อมูล Wi-Fi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #f0f2f5;
        }
        .chart-container {
            position: relative;
            width: 100%;
        }
        .card {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            padding: 1.5rem;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        }
        .header-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: #1a202c;
        }
        .sub-header {
            font-size: 0.875rem;
            color: #718096;
        }
    </style>
</head>
<body class="p-4 sm:p-6 md:p-8">

    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <header class="mb-8 flex flex-col sm:flex-row justify-between items-start sm:items-center">
             <div>
                <h1 class="text-3xl font-bold text-gray-800">แดชบอร์ดสรุปข้อมูล Wi-Fi</h1>
                <p class="text-gray-500 mt-1">ภาพรวมประสิทธิภาพและปัญหาของระบบ Wi-Fi ประจำเดือน</p>
             </div>
             <button class="mt-4 sm:mt-0 w-full sm:w-auto bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-transform transform hover:scale-105 flex items-center justify-center flex-shrink-0">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                ดาวน์โหลดรายงานฉบับเต็ม
            </button>
        </header>

        <!-- Main Layout -->
        <div class="flex flex-col gap-6">
            
            <!-- Section 1 -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Wi-Fi Availability (รายเดือน) -->
                <div class="card">
                    <div class="flex justify-between items-start">
                        <div>
                            <h2 class="header-title">Wi-Fi Availability (รายเดือน)</h2>
                            <p class="sub-header">เปอร์เซ็นต์ความพร้อมใช้งานของสัญญาณ Wi-Fi</p>
                        </div>
                        <div class="text-right">
                             <p class="text-3xl font-bold text-teal-600" id="avgAvailability">99.85%</p>
                             <p class="text-sm text-gray-500">เฉลี่ยเดือนนี้</p>
                        </div>
                    </div>
                    <div class="mt-4 chart-container" style="height: 350px;">
                        <canvas id="availabilityChart"></canvas>
                    </div>
                </div>
                <!-- จำนวน Fault Wi-Fi แบ่งตาม Zone -->
                <div class="card">
                    <h2 class="header-title">จำนวน Fault Wi-Fi ตามโซน</h2>
                    <p class="sub-header">สัดส่วนปัญหาที่เกิดขึ้นในแต่ละพื้นที่</p>
                    <div class="mt-4 chart-container" style="height: 350px;">
                        <canvas id="faultZoneChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Section 2 -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- สัดส่วนผู้ใช้งาน (Client) ตามภาค -->
                <div class="card">
                    <h3 class="header-title text-center">สัดส่วนผู้ใช้งาน (Client) ตามภาค</h3>
                    <div class="chart-container mt-2" style="height: 350px;">
                        <canvas id="regionClientChart"></canvas>
                    </div>
                </div>
                <!-- 10 อันดับจังหวัดตามปริมาณใช้งาน (Usage) -->
                <div class="card">
                    <h3 class="header-title text-center">10 อันดับจังหวัดตามปริมาณใช้งาน (Usage)</h3>
                    <div class="chart-container mt-2" style="height: 350px;">
                        <canvas id="provinceUsageChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Section 3 -->
            <div class="card">
                <h2 class="header-title">สรุปข้อมูลการใช้งานรายสาขา</h2>
                <p class="sub-header">20 อันดับแรกตามปริมาณการใช้งานและจำนวนผู้ใช้</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-12 mt-4">
                    <div>
                        <h3 class="font-bold text-center text-gray-700">ปริมาณการใช้งาน (Usage)</h3>
                        <div class="chart-container mt-2" style="height: 450px;">
                            <canvas id="topUsageChart"></canvas>
                        </div>
                    </div>
                    <div>
                        <h3 class="font-bold text-center text-gray-700">จำนวนผู้ใช้ (Client)</h3>
                        <div class="chart-container mt-2" style="height: 450px;">
                            <canvas id="topUsersChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        // --- Professional Color Palette ---
        const professionalColors = ['#36A2EB', '#4BC0C0', '#FFCD56', '#FF9F40', '#9966FF', '#C9CBCF'];
        const primaryColor = 'rgba(54, 162, 235, 0.8)'; // Blue
        const primaryBorderColor = 'rgba(54, 162, 235, 1)';
        const secondaryColor = 'rgba(75, 192, 192, 0.8)'; // Teal
        const secondaryBorderColor = 'rgba(75, 192, 192, 1)';
        const accentColor = 'rgba(255, 159, 64, 0.8)'; // Orange
        const accentBorderColor = 'rgba(255, 159, 64, 1)';

        // --- Mock Data for top charts ---
        const daysInMonth = Array.from({ length: 30 }, (_, i) => `วันที่ ${i + 1}`);
        const availabilityData = Array.from({ length: 30 }, () => 99.5 + Math.random() * 0.5);
        const avgAvailability = (availabilityData.reduce((a, b) => a + b, 0) / availabilityData.length).toFixed(2);
        document.getElementById('avgAvailability').textContent = `${avgAvailability}%`;

        const faultZones = ['กรุงเทพและปริมณฑล', 'ภาคเหนือ', 'ภาคตะวันออกเฉียงเหนือ', 'ภาคกลาง', 'ภาคตะวันออก', 'ภาคใต้'];
        const faultData = [120, 55, 80, 60, 45, 70];

        // --- Real Data from User ---
        const top20ClientData = {
            labels: [
                '19854 - Ao Tonsai Beach', '20200 - พร้อมดินแดง', '19990 - ศาลายามาร์เก็ต', '5038 - ประชานุเคราะห์ 2',
                '3807 - สี่แยกทรายรี', '8354 - ปตท.เพชรบุรีล้ำยุค (วังมะนาว) จุด 1', '1159 - ต้นลำใย', '10281 - ตลาดโต้รุ่งกาญจน์',
                '5039 - ตลาดทรายรี', '1941 - หาดแม่หาด', '19150 - สาย2จอมเทียน ตลาดร่มโพธิ์ (พัทยา)', '8094 - บุลำดวน',
                '6200 - เจ็ดยอดพลาซ่า', '15448 - BMN MRT จตุจักร', '18180 - พัทยาสาย 1 เบย์วอล์ค', '20260 - นาเกลือ ซอย 16-หาดยาว (ชลบุรี)',
                '2233 - อยุธยาเมืองใหม่ ซอย 3', '22515 - Buddy (ถนนข้าวสาร)', '6661 - หอนาฬิกา 2', '202 - เอกมัย'
            ],
            data: [
                10849, 7123, 6733, 6100, 5605, 5274, 5248, 5187, 5001, 4917, 4888, 4680,
                4670, 4274, 4265, 4257, 4212, 4184, 4167, 4138
            ]
        };

        const top20UsageData = {
            labels: [
                '754 - วิเศษชัยชาญ', '13471 - แครายเทพกาญจนา', '5305 - ชุมชนวัดเชิงเขา (สระบุรี)', '18966 - ชุมชนชัยมงคล(ชะอำ)',
                '4061 - ปตท.ดอนหวาย', '9710 - PTTOR ประจักษ์ศิลปาคม', '1159 - ต้นลำใย', '18369 - มิตรสัมพันธ์ ซ.18',
                '6200 - เจ็ดยอดพลาซ่า', '9473 - หอพักสวนดอก (ถ.ศิริมังคลาจารย์)', '18338 - ลาดบัวขาว', '5561 - ตลาดรถไฟบ้านไผ่',
                '3155 - ท่ารถขนส่งอยุธยา', '13486 - PTTOR ธรรมศาลา (ขาเข้า)', '5892 - ตลาดเทศบาล (นครปฐม)', '3955 - PTTORมิตรภาพเลิศสวัสดิ์',
                '18349 - เพิ่มสิน 3', '8780 - ปตท.ตลิ่งชัน (บรมราชชนนี)', '18373 - นาพระชัย', '2233 - อยุธยาเมืองใหม่ ซอย 3'
            ],
            data: [
                953.84, 767.06, 664.63, 633.97, 610.60, 562.67, 552.80, 548.26, 544.86,
                538.86, 533.82, 515.99, 495.62, 492.64, 479.70, 459.21, 452.53, 447.30,
                441.33, 439.32
            ]
        };
        
        // --- Data Processing for Region and Province Charts ---
        const allBranchesData = [
            { id: 19854, name: 'Ao Tonsai Beach', region: 'ภาคใต้', province: 'กระบี่', client: 10849, usage: 112.22 }, { id: 20200, name: 'พร้อมดินแดง', region: 'ภาคกลาง', province: 'กรุงเทพมหานคร', client: 7123, usage: 108.13 }, { id: 19990, name: 'ศาลายามาร์เก็ต', region: 'ภาคกลาง', province: 'นครปฐม', client: 6733, usage: 131.10 }, { id: 5038, name: 'ประชานุเคราะห์ 2', region: 'ภาคใต้', province: 'ภูเก็ต', client: 6100, usage: 255.14 }, { id: 3807, name: 'สี่แยกทรายรี', region: '#N/A', province: '#N/A', client: 5605, usage: 196.28 }, { id: 8354, name: 'ปตท.เพชรบุรีล้ำยุค (วังมะนาว) จุด 1', region: 'ภาคตะวันตก', province: 'เพชรบุรี', client: 5274, usage: 75.47 }, { id: 1159, name: 'ต้นลำใย', region: 'ภาคเหนือ', province: 'เชียงใหม่', client: 5248, usage: 552.80 }, { id: 10281, name: 'ตลาดโต้รุ่งกาญจน์', region: 'ภาคตะวันตก', province: 'กาญจนบุรี', client: 5187, usage: 90.43 }, { id: 5039, name: 'ตลาดทรายรี', region: '#N/A', province: '#N/A', client: 5001, usage: 216.58 }, { id: 1941, name: 'หาดแม่หาด', region: '#N/A', province: '#N/A', client: 4917, usage: 183.03 }, { id: 19150, name: 'สาย2จอมเทียน ตลาดร่มโพธิ์ (พัทยา)', region: 'ภาคตะวันออก', province: 'ชลบุรี', client: 4888, usage: 74.76 }, { id: 8094, name: 'บุลำดวน', region: 'ภาคตะวันออกเฉียงเหนือ', province: 'บุรีรัมย์', client: 4680, usage: 170.99 }, { id: 6200, name: 'เจ็ดยอดพลาซ่า', region: 'ภาคเหนือ', province: 'เชียงใหม่', client: 4670, usage: 544.86 }, { id: 15448, name: 'BMN MRT จตุจักร', region: 'ภาคกลาง', province: 'กรุงเทพมหานคร', client: 4274, usage: 203.13 }, { id: 18180, name: 'พัทยาสาย 1 เบย์วอล์ค', region: 'ภาคตะวันออก', province: 'ชลบุรี', client: 4265, usage: 233.46 }, { id: 20260, name: 'นาเกลือ ซอย 16-หาดยาว (ชลบุรี)', region: 'ภาคตะวันออก', province: 'ชลบุรี', client: 4257, usage: 103.64 }, { id: 2233, name: 'อยุธยาเมืองใหม่ ซอย 3', region: 'ภาคกลาง', province: 'พระนครศรีอยุธยา', client: 4212, usage: 439.32 }, { id: 22515, name: 'Buddy (ถนนข้าวสาร)', region: 'ภาคกลาง', province: 'กรุงเทพมหานคร', client: 4184, usage: 98.24 }, { id: 6661, name: 'หอนาฬิกา 2', region: 'ภาคเหนือ', province: 'เชียงราย', client: 4167, usage: 384.65 }, { id: 202, name: 'เอกมัย', region: 'ภาคกลาง', province: 'กรุงเทพมหานคร', client: 4138, usage: 54.88 }, { id: 754, name: 'วิเศษชัยชาญ', region: 'ภาคกลาง', province: 'อ่างทอง', client: 3593, usage: 953.84 }, { id: 13471, name: 'แครายเทพกาญจนา', region: 'ภาคกลาง', province: 'สมุทรสาคร', client: 2688, usage: 767.06 }, { id: 5305, name: 'ชุมชนวัดเชิงเขา (สระบุรี)', region: 'ภาคกลาง', province: 'สระบุรี', client: 2128, usage: 664.63 }, { id: 18966, name: 'ชุมชนชัยมงคล(ชะอำ)', region: 'ภาคตะวันตก', province: 'เพชรบุรี', client: 1851, usage: 633.97 }, { id: 4061, name: 'ปตท.ดอนหวาย', region: 'ภาคตะวันออกเฉียงเหนือ', province: 'นครราชสีมา', client: 2130, usage: 610.60 }, { id: 9710, name: 'PTTOR ประจักษ์ศิลปาคม', region: 'ภาคตะวันออกเฉียงเหนือ', province: 'อุดรธานี', client: 2814, usage: 562.67 }, { id: 18369, name: 'มิตรสัมพันธ์ ซ.18', region: 'ภาคตะวันออก', province: 'ชลบุรี', client: 1810, usage: 548.26 }, { id: 9473, name: 'หอพักสวนดอก (ถ.ศิริมังคลาจารย์)', region: '#N/A', province: '#N/A', client: 692, usage: 538.86 }, { id: 18338, name: 'ลาดบัวขาว', region: 'ภาคตะวันออกเฉียงเหนือ', province: 'นครราชสีมา', client: 1937, usage: 533.82 }, { id: 5561, name: 'ตลาดรถไฟบ้านไผ่', region: 'ภาคตะวันออกเฉียงเหนือ', province: 'ขอนแก่น', client: 2295, usage: 515.99 }, { id: 3155, name: 'ท่ารถขนส่งอยุธยา', region: 'ภาคกลาง', province: 'พระนครศรีอยุธยา', client: 3087, usage: 495.62 }, { id: 13486, name: 'PTTOR ธรรมศาลา (ขาเข้า)', region: 'ภาคกลาง', province: 'นครปฐม', client: 3229, usage: 492.64 }, { id: 5892, name: 'ตลาดเทศบาล (นครปฐม)', region: 'ภาคกลาง', province: 'นครปฐม', client: 2664, usage: 479.70 }, { id: 3955, name: 'PTTORมิตรภาพเลิศสวัสดิ์', region: 'ภาคตะวันออกเฉียงเหนือ', province: 'นครราชสีมา', client: 3283, usage: 459.21 }, { id: 18349, name: 'เพิ่มสิน 3', region: 'ภาคกลาง', province: 'กรุงเทพมหานคร', client: 2732, usage: 452.53 }, { id: 8780, name: 'ปตท.ตลิ่งชัน (บรมราชชนนี)', region: 'ภาคกลาง', province: 'กรุงเทพมหานคร', client: 1469, usage: 447.30 }, { id: 18373, name: 'นาพระชัย', region: 'ภาคตะวันออกเฉียงเหนือ', province: 'นครพนม', client: 1397, usage: 441.33 },
        ];

        const regionSummary = allBranchesData.reduce((acc, branch) => { const region = branch.region; if (region && region !== '#N/A') { if (!acc[region]) { acc[region] = { client: 0, usage: 0 }; } acc[region].client += branch.client; acc[region].usage += branch.usage; } return acc; }, {});
        const provinceSummary = allBranchesData.reduce((acc, branch) => { const province = branch.province; if (province && province !== '#N/A') { if (!acc[province]) { acc[province] = { client: 0, usage: 0 }; } acc[province].client += branch.client; acc[province].usage += branch.usage; } return acc; }, {});
        
        // --- Chart Rendering ---
        const availabilityCtx = document.getElementById('availabilityChart').getContext('2d');
        new Chart(availabilityCtx, { type: 'line', data: { labels: daysInMonth, datasets: [{ label: 'Availability (%)', data: availabilityData, borderColor: secondaryBorderColor, backgroundColor: 'rgba(75, 192, 192, 0.2)', fill: true, tension: 0.4, pointRadius: 2, pointBackgroundColor: secondaryBorderColor }] }, options: { responsive: true, maintainAspectRatio: false, scales: { y: { min: 98.5, max: 100, ticks: { callback: (value) => value + '%' } }, x: { ticks: { maxRotation: 0, minRotation: 0, autoSkip: true, maxTicksLimit: 15 } } }, plugins: { legend: { display: false }, tooltip: { callbacks: { label: (context) => `Availability: ${context.raw.toFixed(2)}%` } } } } });
        
        const faultZoneCtx = document.getElementById('faultZoneChart').getContext('2d');
        new Chart(faultZoneCtx, { type: 'doughnut', data: { labels: faultZones, datasets: [{ label: 'จำนวน Faults', data: faultData, backgroundColor: professionalColors, hoverOffset: 4, borderWidth: 2, borderColor: '#ffffff' }] }, options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom', labels: { padding: 15, boxWidth: 12, usePointStyle: true, pointStyle: 'circle' } } } } });
        
        const topUsageCtx = document.getElementById('topUsageChart').getContext('2d');
        new Chart(topUsageCtx, { type: 'bar', data: { labels: top20UsageData.labels, datasets: [{ label: 'Usage (GB)', data: top20UsageData.data, backgroundColor: primaryColor, borderColor: primaryBorderColor, borderWidth: 1, borderRadius: 4 }] }, options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { beginAtZero: true, title: { display: true, text: 'Usage (GB)' } } } } });
        
        const topUsersCtx = document.getElementById('topUsersChart').getContext('2d');
        new Chart(topUsersCtx, { type: 'bar', data: { labels: top20ClientData.labels, datasets: [{ label: 'จำนวน Client', data: top20ClientData.data, backgroundColor: secondaryColor, borderColor: secondaryBorderColor, borderWidth: 1, borderRadius: 4 }] }, options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { beginAtZero: true, title: { display: true, text: 'จำนวน Client (คน)' } } } } });

        const regionClientCtx = document.getElementById('regionClientChart').getContext('2d');
        const regionLabels = Object.keys(regionSummary);
        const regionClientData = regionLabels.map(region => regionSummary[region].client);
        new Chart(regionClientCtx, {
            type: 'pie',
            data: {
                labels: regionLabels,
                datasets: [{
                    label: 'จำนวน Client',
                    data: regionClientData,
                    backgroundColor: professionalColors,
                    hoverOffset: 4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'bottom' }
                }
            }
        });

        const provinceUsageCtx = document.getElementById('provinceUsageChart').getContext('2d');
        const sortedProvinces = Object.entries(provinceSummary).sort(([,a],[,b]) => b.usage - a.usage).slice(0, 10);
        const provinceLabels = sortedProvinces.map(p => p[0]);
        const provinceUsageData = sortedProvinces.map(p => p[1].usage.toFixed(2));
        new Chart(provinceUsageCtx, {
            type: 'bar',
            data: {
                labels: provinceLabels,
                datasets: [{
                    label: 'Usage (GB)',
                    data: provinceUsageData,
                    backgroundColor: accentColor,
                    borderColor: accentBorderColor,
                    borderWidth: 1,
                    borderRadius: 4
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: { x: { beginAtZero: true, title: { display: true, text: 'Usage (GB)' } } }
            }
        });

    </script>
</body>
</html>
